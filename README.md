# Labpics MCP Bot ‚Äî –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–∏–∑–∞–π–Ω‚Äë—Å—Ç—É–¥–∏–∏ (Telegram + Cloudflare Workers + Supabase)

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π ‚Äî backend –ø—Ä–æ–¥—É–∫—Ç–∞ –¥–ª—è **—É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞–º–∏ –¥–∏–∑–∞–π–Ω‚Äë—Å—Ç—É–¥–∏–∏** —á–µ—Ä–µ–∑ Telegram‚Äë–±–æ—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ ‚Äú–æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π –ø–∞–º—è—Ç–∏‚Äù –∏–∑ –ø–µ—Ä–µ–ø–∏—Å–æ–∫ —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏.

–ü—Ä–æ–¥—É–∫—Ç –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫:
- **Chatwoot** ‚Äî –∫–∞–Ω–∞–ª –æ–±—â–µ–Ω–∏—è —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏ (–∏—Å—Ç–æ—á–Ω–∏–∫ –ø–µ—Ä–µ–ø–∏—Å–æ–∫).
- **Supabase (Postgres + pgvector)** ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –≤–µ–∫—Ç–æ—Ä–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ, –≥–¥–µ –ª–µ–∂–∏—Ç –∏—Å—Ç–æ—Ä–∏—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞.
- **Linear** ‚Äî PM/—Ç–∞—Å–∫‚Äë—Ç—Ä–µ–∫–∏–Ω–≥ (—Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á –ø–æ action items/–¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç—è–º).
- **Attio** ‚Äî CRM (–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫ –∫–ª–∏–µ–Ω—Ç–∞/–∫–æ–º–ø–∞–Ω–∏–∏/—Å–¥–µ–ª–∫–∏ —Ñ–∞–∫—Ç–∞–º–∏ –∏–∑ –ø–µ—Ä–µ–ø–∏—Å–æ–∫).
- **Telegram** ‚Äî –µ–¥–∏–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–∫–Ω–æ–ø–∫–∏ + —Ç–µ–∫—Å—Ç + –≥–æ–ª–æ—Å).

> –°—Ç–∞—Ç—É—Å—ã –≤ README:
> - ‚úÖ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
> - üß™ –ø—Ä–æ—Ç–æ—Ç–∏–ø / —á–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
> - üó∫Ô∏è –≤ –ø–ª–∞–Ω–∞—Ö

---

## –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ (–ø—Ä–æ–±–ª–µ–º–∞ ‚Üí —Ä–µ—à–µ–Ω–∏–µ)

–í —Å—Ç—É–¥–∏–∏ –ø—Ä–æ–µ–∫—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç —á–∞—Å—Ç–æ –ª–æ–º–∞–µ—Ç—Å—è –∏–∑‚Äë–∑–∞:
- –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏ ‚Äú—Ç–µ—Ä—è—é—Ç—Å—è‚Äù –≤ –ø–µ—Ä–µ–ø–∏—Å–∫–∞—Ö;
- –∏–Ω—Å–∞–π—Ç—ã –∫–ª–∏–µ–Ω—Ç–∞ –Ω–µ —Ñ–∏–∫—Å–∏—Ä—É—é—Ç—Å—è;
- –∑–∞–¥–∞—á–∏ –≤ PM –ø–æ—è–≤–ª—è—é—Ç—Å—è —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π;
- CRM –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é –∏ –≤—Å–µ–≥–¥–∞ –Ω–µ–ø–æ–ª–Ω–∞—è;
- –∫–æ–Ω—Ç–µ–∫—Å—Ç —Ä–∞–∑–º–∞–∑–∞–Ω –ø–æ –ª—é–¥—è–º –∏ –∫–∞–Ω–∞–ª–∞–º.

**Labpics MCP Bot** –¥–µ–ª–∞–µ—Ç –ø–µ—Ä–µ–ø–∏—Å–∫—É —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä—É–µ–º–æ–π:
- –∏–∑–≤–ª–µ–∫–∞–µ—Ç **–¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏ / action items**;
- —Ö—Ä–∞–Ω–∏—Ç ‚Äú–æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—É—é –ø–∞–º—è—Ç—å‚Äù –ø—Ä–æ–µ–∫—Ç–∞;
- –ø–æ–∑–≤–æ–ª—è–µ—Ç **—É–ø—Ä–∞–≤–ª—è—Ç—å** –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ (CRM/PM) ‚Äú–ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É‚Äù;
- –≤—Å—ë —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ‚Äî –≤ Telegram.

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (3 Cloudflare Worker‚Äô–∞)

### 1) `tgbot` ‚Äî Telegram UI / –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä
- ‚úÖ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç Telegram webhook
- ‚úÖ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–Ω–æ–ø–∫–∏ (Home / Projects / Dashboard / Search / –î–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏)
- ‚úÖ —Ö—Ä–∞–Ω–∏—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∞–∫—Ç–∏–≤–Ω—ã–π –ø—Ä–æ–µ–∫—Ç, –æ–∂–∏–¥–∞–µ–º—ã–π –≤–≤–æ–¥)
- ‚úÖ –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –≤ `agent-gw` –ø–æ Service Binding

### 2) `agent-gw` ‚Äî –∞–≥–µ–Ω—Ç (LLM + –ª–æ–≥–∏–∫–∞)
- ‚úÖ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –æ—Ç `tgbot`
- ‚úÖ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç intent (–ø–æ–∏—Å–∫ / –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏)
- ‚úÖ –¥–µ–ª–∞–µ—Ç –ø—Ä–æ—Å—Ç–æ–π –ø–æ–∏—Å–∫ –ø–æ –ø–∞–º—è—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
- ‚úÖ –∏–∑–≤–ª–µ–∫–∞–µ—Ç commitments (–¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏) –∏ –ø–∏—à–µ—Ç –≤ Supabase
- üß™ –≥–æ—Ç–æ–≤–∏—Ç –æ—Å–Ω–æ–≤—É –¥–ª—è –¥–µ–π—Å—Ç–≤–∏–π –≤ Linear/Attio (—á–µ—Ä–µ–∑ —Ç–∞–±–ª–∏—Ü—ã linking/automation), –Ω–æ –Ω–µ –≤—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –≤–∫–ª—é—á–µ–Ω—ã –≤ UI

### 3) `cw-sync` ‚Äî ingestion (Chatwoot ‚Üí Supabase + embeddings)
- ‚úÖ –∑–∞–±–∏—Ä–∞–µ—Ç –ø–µ—Ä–µ–ø–∏—Å–∫–∏ –∏–∑ Chatwoot (conversations/messages)
- ‚úÖ –ø–∏—à–µ—Ç ‚Äú—Å—ã—Ä—ã–µ‚Äù –¥–∞–Ω–Ω—ã–µ –≤ `cw_*` —Ç–∞–±–ª–∏—Ü—ã
- ‚úÖ —Ä–µ–∂–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ —á–∞–Ω–∫–∏ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ `rag_chunks`
- ‚úÖ —Å—á–∏—Ç–∞–µ—Ç embeddings —á–µ—Ä–µ–∑ OpenAI –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ `rag_chunks.embedding`
- ‚úÖ –≤–µ–¥—ë—Ç watermark (–∫—É—Ä—Å–æ—Ä —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏)

---

## –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: —á—Ç–æ –≥–¥–µ –ª–µ–∂–∏—Ç

- `tgbot/src/index.js` ‚Äî Telegram worker
- `agent-gw/src/index.js` ‚Äî agent gateway
- `cw-sync/src/index.js` ‚Äî Chatwoot ingestion + embeddings

CI/CD:
- `.github/workflows/deploy-dev.yml` ‚Äî –¥–µ–ø–ª–æ–π dev
- `.github/workflows/deploy-prod.yml` ‚Äî –¥–µ–ø–ª–æ–π prod

Wrangler configs:
- `tgbot/wrangler.toml` ‚Äî prod binding –Ω–∞ `agent-gw`
- `tgbot/wrangler.dev.toml` ‚Äî dev binding –Ω–∞ `agent-gw-dev`
- `agent-gw/wrangler.toml`
- `cw-sync/wrangler.toml`

---

## Supabase: –∫–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ (–≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤–æ)

### –ü—Ä–æ–µ–∫—Ç—ã –∏ –ª–∏–Ω–∫–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º
- ‚úÖ `projects` ‚Äî —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤ —Å—Ç—É–¥–∏–∏.
- ‚úÖ `project_links` ‚Äî —Å–ª–æ–π —Å–≤—è–∑–µ–π –ø—Ä–æ–µ–∫—Ç–∞ —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å—É—â–Ω–æ—Å—Ç—è–º–∏ (Chatwoot/Attio/Linear).
  
  –ü—Ä–∏–º–µ—Ä: ‚Äú—ç—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç ‚Üî —ç—Ç–∞ —Å–¥–µ–ª–∫–∞ –≤ Attio ‚Üî —ç—Ç–æ—Ç Linear project ‚Üî —ç—Ç–æ—Ç Chatwoot conversation‚Äù.

### –ü–µ—Ä–µ–ø–∏—Å–∫–∏ –∏–∑ Chatwoot
- ‚úÖ `cw_conversations`
- ‚úÖ `cw_messages`
- ‚úÖ `cw_contacts`
- üß™ `cw_webhook_events` (–µ—Å—Ç—å —Ç–∞–±–ª–∏—Ü–∞, –Ω–æ ingestion —Å–µ–π—á–∞—Å —Ä–∞–±–æ—Ç–∞–µ—Ç polling‚Äô–æ–º —á–µ—Ä–µ–∑ `cw-sync`)

### –í–µ–∫—Ç–æ—Ä–Ω–∞—è –ø–∞–º—è—Ç—å / RAG
- ‚úÖ `rag_chunks` ‚Äî —á–∞–Ω–∫–∏ —Ç–µ–∫—Å—Ç–∞ + `embedding vector` + –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ/–ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ.
- üß™ embedding‚Äë–ø–æ–∏—Å–∫ —á–µ—Ä–µ–∑ RPC `match_rag_chunks(...)` (–≤ –ë–î –µ—Å—Ç—å, –Ω–æ –∞–≥–µ–Ω—Ç—Å–∫–∏–π –ø–æ–∏—Å–∫ –º–æ–∂–µ—Ç –±—ã—Ç—å MVP)

### –î–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏ / Action items
- ‚úÖ `project_commitments` ‚Äî –∫—Ç–æ/—á—Ç–æ/–∫–æ–≥–¥–∞/—Å—Ç–∞—Ç—É—Å + evidence (—Å—Å—ã–ª–∫–∞ –Ω–∞ chunk/—Å–æ–æ–±—â–µ–Ω–∏–µ).
- ‚úÖ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è (–ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—É—Å–∫ –Ω–µ –¥–æ–ª–∂–µ–Ω –ª–æ–º–∞—Ç—å UX)

### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∏ –∞—É–¥–∏—Ç
- üß™ `automation_settings` ‚Äî –ø—Ä–∞–≤–∏–ª–∞/—Ñ–ª–∞–≥–∏ (suggestions/auto-safe)
- üß™ `automation_jobs` ‚Äî –æ—á–µ—Ä–µ–¥—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏–π (–∑–∞–¥–µ–ª)
- ‚úÖ `audit_log` ‚Äî –∂—É—Ä–Ω–∞–ª –¥–µ–π—Å—Ç–≤–∏–π

---

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –ø—Ä–æ–¥—É–∫—Ç–∞ (—á—Ç–æ –±—É–¥–µ—Ç –≤ –ø—Ä–æ–¥—É–∫—Ç–µ)

–ù–∏–∂–µ ‚Äî –ø–æ–ª–Ω—ã–π –ø–µ—Ä–µ—á–µ–Ω—å —Ñ—É–Ω–∫—Ü–∏–π, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞.

### A) –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞–º–∏ (Telegram)
- ‚úÖ –°–ø–∏—Å–æ–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
- ‚úÖ –í—ã–±–æ—Ä –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
- ‚úÖ Dashboard –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
- üó∫Ô∏è –ü—Ä–∏–≤—è–∑–∫–∞/–æ—Ç–≤—è–∑–∫–∞ –≤–Ω–µ—à–Ω–∏—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π (Chatwoot/Attio/Linear) –∫ –ø—Ä–æ–µ–∫—Ç—É —á–µ—Ä–µ–∑ UI
- üó∫Ô∏è –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–º–µ—Ç–æ–∫/–∏–Ω—Å–∞–π—Ç–æ–≤ –ø–æ –ø—Ä–æ–µ–∫—Ç—É (—Å evidence)

### B) –ü–æ–∏—Å–∫ –ø–æ –ø–µ—Ä–µ–ø–∏—Å–∫–∞–º (RAG)
- ‚úÖ –ü–æ–∏—Å–∫ –ø–æ –ø–∞–º—è—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞ –ø–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–º—É –∑–∞–ø—Ä–æ—Å—É (MVP)
- üß™ –ü–æ–∫–∞–∑ –Ω–∞–∏–±–æ–ª–µ–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤ —Å —Ö–æ—Ä–æ—à–∏–º —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- üó∫Ô∏è –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π embedding‚Äë–ø–æ–∏—Å–∫ —á–µ—Ä–µ–∑ `match_rag_chunks` (–≤–º–µ—Å—Ç–æ `ilike`)

### C) –î–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏ (Commitments)
- ‚úÖ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–µ–π –∏–∑ –ø–µ—Ä–µ–ø–∏—Å–æ–∫ (–∫—Ç–æ —á—Ç–æ –¥–æ–ª–∂–µ–Ω, —Å—Ä–æ–∫–∏)
- ‚úÖ –°–ø–∏—Å–æ–∫ –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–µ–π –ø–æ –ø—Ä–æ–µ–∫—Ç—É
- ‚úÖ –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Å—Ç–æ—Ä–æ–Ω–µ: `client` / `us`
- ‚úÖ –°—Ç–∞—Ç—É—Å—ã: `pending` / `done` / `canceled`
- üó∫Ô∏è UI‚Äë—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º: –æ—Ç–º–µ—Ç–∏—Ç—å done/cancel, –Ω–∞–∑–Ω–∞—á–∏—Ç—å –≤–ª–∞–¥–µ–ª—å—Ü–∞, –ø–æ—Å—Ç–∞–≤–∏—Ç—å due

### D) PM (Linear)
- üß™ –°–æ–∑–¥–∞–Ω–∏–µ Linear issues –∏–∑ commitments / action items (–∫–∞–∫ —Å—Ü–µ–Ω–∞—Ä–∏–π —É–∂–µ –ø—Ä–æ–≤–µ—Ä—è–ª–æ—Å—å)
- üó∫Ô∏è –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤/–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤/—Å—Ä–æ–∫–æ–≤ –∏–∑ Telegram
- üó∫Ô∏è Weekly report (–ø–æ –ø—Ä–æ–µ–∫—Ç—É): —á—Ç–æ —Å–¥–µ–ª–∞–Ω–æ / —á—Ç–æ –Ω—É–∂–Ω–æ / –±–ª–æ–∫–µ—Ä—ã

### E) CRM (Attio)
- üß™ –ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ Company/Person/Deal —Ñ–∞–∫—Ç–∞–º–∏ –∏–∑ –ø–µ—Ä–µ–ø–∏—Å–æ–∫ (–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π)
- üó∫Ô∏è –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤ Telegram (apply patch)
- üó∫Ô∏è –ê—É–¥–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å –ø—Ä–∏–≤—è–∑–∫–æ–π –∫ evidence

### F) Ingestion / —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è (Chatwoot ‚Üí Supabase)
- ‚úÖ –†–µ–≥—É–ª—è—Ä–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–æ–≤—ã—Ö —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤/—Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ Watermark/–∫—É—Ä—Å–æ—Ä (—á—Ç–æ–±—ã –Ω–µ –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É)
- ‚úÖ –ß–∞–Ω–∫–∏–Ω–≥ —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ embeddings –ø–∞–∫–µ—Ç–∞–º–∏
- ‚úÖ –†—É—á–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã `/sync` –∏ `/embed` (Bearer `SYNC_TOKEN`)

### G) –ì–æ–ª–æ—Å–æ–≤—ã–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- üß™ –¢—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è voice ‚Üí —Ç–µ–∫—Å—Ç (–µ—Å–ª–∏ –≤–∫–ª—é—á–∏—Ç—å –∫–ª—é—á –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫)
- üß™ –ü—Ä–æ–≥–æ–Ω —á–µ—Ä–µ–∑ `agent-gw` –∫–∞–∫ –æ–±—ã—á–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞

---

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (Cloudflare Workers)

### –í–æ—Ä–∫–µ—Ä—ã
–í –ø—Ä–æ–µ–∫—Ç–µ —Ç—Ä–∏ –≤–æ—Ä–∫–µ—Ä–∞:
- `tgbot/src/index.js`
- `agent-gw/src/index.js`
- `cw-sync/src/index.js`

### –í–∞–∂–Ω–æ–µ –ø—Ä–æ –¥–µ–ø–ª–æ–π
- ‚úÖ –¥–µ–ø–ª–æ–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ GitHub Actions + `wrangler`
- ‚úÖ runtime vars/secrets –ø—Ä–æ–∫–∏–¥—ã–≤–∞—é—Ç—Å—è –≤ Cloudflare –ø—Ä–∏ –¥–µ–ø–ª–æ–µ (GitHub Environments ‚Üí Cloudflare)

---

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (Cloudflare runtime)

> –í CI —ç—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è –±–µ—Ä—É—Ç—Å—è –∏–∑ GitHub Environments `dev` / `production`.

### –û–±—â–∏–µ (–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –≤–æ—Ä–∫–µ—Ä–∞–º–∏)
**Vars:**
- `SUPABASE_URL`
- `SUPABASE_PROJECT_REF`
- `ENV`

**Secrets:**
- `SUPABASE_SERVICE_ROLE_KEY`
- `OPENAI_API_KEY`

### `tgbot`
**Vars:**
- `TELEGRAM_WEBHOOK_PATH`
- `PUBLIC_BASE_URL`
- `AGENT_GATEWAY_URL`
- `CHATWOOT_BASE_URL`
- `CHATWOOT_ACCOUNT_ID`

**Secrets:**
- `TELEGRAM_BOT_TOKEN`
- `CHATWOOT_API_TOKEN`
- `AGENT_GATEWAY_HMAC_SECRET`
- `COMPOSIO_API_KEY`
- `APP_HMAC_SECRET` (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

Service Binding:
- ‚úÖ `AGENT_GW` ‚Üí `agent-gw` (prod)
- ‚úÖ `AGENT_GW` ‚Üí `agent-gw-dev` (dev)

### `agent-gw`
**Vars:**
- `SUPABASE_URL`

**Secrets:**
- `SUPABASE_SERVICE_ROLE_KEY`
- `OPENAI_API_KEY`
- `AGENT_GATEWAY_HMAC_SECRET`
- `COMPOSIO_API_KEY` (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

### `cw-sync`
**Vars:**
- `CHATWOOT_BASE_URL`
- `CHATWOOT_ACCOUNT_ID`
- `SYNC_TABLE` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `rag_chatwoot_sync_state`)
- `RAG_TABLE` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `rag_chunks`)

**Secrets:**
- `CHATWOOT_API_TOKEN`
- `SUPABASE_SERVICE_ROLE_KEY`
- `OPENAI_API_KEY`
- `SYNC_TOKEN` (Bearer –¥–ª—è —Ä—É—á–Ω—ã—Ö –∑–∞–ø—É—Å–∫–æ–≤)

–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã:
- ‚úÖ `GET /health`
- ‚úÖ `GET /sync` (Authorization: Bearer $SYNC_TOKEN)
- ‚úÖ `GET /embed` (Authorization: Bearer $SYNC_TOKEN)

---

## GitHub Actions –¥–µ–ø–ª–æ–π

Workflows:
- ‚úÖ `Deploy (dev)` ‚Äî auto –Ω–∞ push –≤ `main`, –¥–µ–ø–ª–æ–∏—Ç `tgbot-dev`, `agent-gw-dev`, `cw-sync-dev`
- ‚úÖ `Deploy (prod)` ‚Äî manual, –¥–µ–ø–ª–æ–∏—Ç `tgbot`, `agent-gw`, `cw-sync`

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –ù–µ —Ö—Ä–∞–Ω–∏—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–µ –∫–ª—é—á–∏ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.
- Secrets –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–µ—á–∞—Ç–∞—é—Ç—Å—è –≤ –ª–æ–≥–∞—Ö CI (–Ω–æ –±—É–¥—å—Ç–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã —Å `set -x` –∏ echo).
- `/sync` –∏ `/embed` –∑–∞—â–∏—â–µ–Ω—ã `SYNC_TOKEN`.
- `agent-gw` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã —Ç–æ–ª—å–∫–æ —Å –≤–∞–ª–∏–¥–Ω–æ–π –ø–æ–¥–ø–∏—Å—å—é HMAC.

---

## Roadmap (–∫—Ä–∞—Ç–∫–æ)
- üó∫Ô∏è –ü–µ—Ä–µ–≤–µ—Å—Ç–∏ –ø–æ–∏—Å–∫ –Ω–∞ `match_rag_chunks` (embedding search)
- üó∫Ô∏è UI —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è commitments (done/cancel/assign/due)
- üó∫Ô∏è –ê–≤—Ç–æ‚Äëpatch –¥–ª—è Attio (Company/Deal/People) —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º
- üó∫Ô∏è Weekly PM digest (Linear + commitments + chat insights)
- üó∫Ô∏è Job queue –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–π (`automation_jobs`) + –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ä–µ–∂–∏–º (`auto_safe_enabled`)

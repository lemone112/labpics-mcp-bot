# Спека 0001 — Мультипроектная изоляция памяти (RAG) (READY)

Статус: **ready**

## Факты (что должно быть истинно)

- Любая «память» (переписки, chunks, embeddings, поиск) **жёстко изолирована по проектам**.
- Внутри одного проекта нельзя увидеть данные другого проекта ни при каких входных данных.

## Область

- `cw_*` таблицы
- `rag_chunks`
- `sync_watermarks`
- API list/search endpoints

## Инварианты

1. Все read/write операции фильтруются по `project_id`.
2. Для таблиц, где есть `account_scope_id`, фильтр применяется и по нему.
3. Любой серверный job исполняется в контексте активного проекта.

## Failure modes

- неверный `active_project_id` в сессии
- source binding привязан к не тому проекту
- отсутствие scope фильтра в SQL

## Acceptance criteria

- При наличии данных двух проектов поиск и list endpoints никогда не возвращают чужие данные.
- Повторные прогоны sync/embeddings не смешивают проекты и не создают межпроектные дубликаты.
